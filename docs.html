<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>QStatic modular项目简介</title>
<link rel="stylesheet" href="static/css/bootstrap.css" />
<link rel="stylesheet" href="static/css/docs.css" />
<link rel="stylesheet" href="static/css/pretty-code.css" />
</head>
<body>
    <nav class="navbar navbar-inverse navbar-static-top qm-site-nav" role="navigation">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="/">QStatic Modular</a>
            </div>
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="/">介绍</a></li>
                    <li class="active"><a href="/docs.html">文档</a></li>
                </ul>
            </div>
        </div> 
    </nav>
    <!-- temp remove include('nav.html') -->
    <div class="container qm-docs-container">
        <div class="row">
            <!-- left col-->
            <div class="col-md-9">
               
                <div class="why qm-docs-section">
                    <h1 class="section-header" id="why">为什么使用</h1> 
                    <p>随着前端功能，效果越来越复杂，代码越来越重，
                    实现模块化，已成必然趋势</p>
                    <p>很好的解决了过去js文件间复杂的依赖关系</p>
                    <p>seajs的打包问题，是一个难题，但是我们解决了</p>
                </div>

                <div class="howto qm-docs-section">
                    <h1 class="section-header" id="howto">如何使用</h1> 
                    <p>模块化功能加入之初考虑的就是，如何能像目前静床那样，项目上线只需执行一个deploy(一般加入到f8的init.sh脚本中)无需再做任何改动。
                    很高兴告诉你，我们实现了，上线时仍然只需要执行静床的deploy, 背后会判断是否是模块化项目进行相应的修改(将匿名模块具名，分析依赖)。</p>
                    <h3 id="convention">使用约定：</h3>
                    <ul>
                        <li>
                            <p>文件路径约定：js文件统一存放成<code>static/js</code>, project以js下顶级文件夹形式存放</p>
                            <p></p>
                            <pre class="prettyprint linenums">
                                <code>
--static
    --js
        --common //即目前的commonjs
            jquery.scrollup.js 
        --docs
            common.js
            index.js
            docs.js

                                </code>
                            </pre>
                        </li> 
                        <li>
                            <p>ngix配置约定：即可以通过<code>http://domain/js/path/to/file</code>这样访问</p>
                            <p>如：<code>http://www.qmodular.org/js/common/jquery.scrollup.js</code>访问上面例子中的qload文件</p>
                            <pre class="prettyprint linenums">
                                <code>
location ~* \.(js|css)$ {
    root           ${PRJ_ROOT}/src/web_inf/${APP_SYS}/static;
    index index.html 
    expires 1h;
}
                                </code>
                            </pre>
                        </li>
                        <li>
                            <p>所加载文件必须是符合CMD模块规范的js文件</p>
                            <p>这就要求，如果本来是jquery，jquery插件等不符合CMD模块规范的文件，要改造为CDM模块</p>
                            <pre class="prettyprint linenums">
                                <code>
define(function(require, exports, module) {
    // jQuery code
});   
                                </code>
                            </pre>                        
                        </li> 
                        <li>
                            <p>模块都为写为匿名模块</p>
                            <pre class="prettyprint linenums">
                                <code>
define(function(require, exports, module) {
    exports.log = function(msg) {
        console.log(msg);
    }
});
                                </code>
                            </pre>
                        </li>
                        <div class="qm-notify qm-notify-info">
                            <h4></h4>
                            <p>这是说明内容</p>
                        </div>
                    </ul>
                    <h3 id="method">使用方法：</h3>
                    <ol>
                        <li>
                            <p>跟过去一致的无差别引入静床，在拦截器实例化静床</p> 
                        </li>
                        <li>
                            <p>页面模板中，在模块化使用之前，加载模块化配置文件</p>
                            <p><pre class="prettyprint"><code>$qstatic->addModularConf();</code></pre></p>
                        </li>
                        <li>
                            <p>编写启动文件，加载启动模块(跟正常使用seajs一致)</p>
                            <p>
                                <pre class="prettyprint">
                                    <code>
// index.html
&lt;script&gt;
    seajs.use('doc/index');
&lt;/script&gt;
                                    </code>
                                </pre>
                            </p>
                            <p>
                                <pre class="prettyprint">
                                    <code>
// filepath static/js/docs/index.js
define(function(require, exports, module){

    require('jquery.scrollup');
    $('#scrollTop').scrollUp();
    
    var log = require('common/log');
    log("I'm the qmodular index");
});
                                    </code>
                                </pre>
                            </p>
                        </li>
                        <li>
                            <p>打包，上线 。</p>
                            <p><code>f8</code>选择发布qstatic，余下就交给qstatic和其中的qmodular来处理了</p>
                        </li>
                    </ol>
                </div> 

                <div class="best-practice qm-docs-section">
                    <h1 class="section-header" id="why">最佳实践</h1> 
                    <ul>
                        <li>jQuery这种各处都会使用的js，通过<code>script:src</code>这种方式引入</li>
                        <li>模块功能专一，尽量小</li>
                    </ul>
                </div>

                <div class="other-docs qm-docs-section"> 
                    <h1 class="section-header" id="other-docs">
                       其它文档
                    </h1>
                    <p>静床，以及静床模块化相关的文档</p>
                    <h3 id="qstatic-docs">静床基础文档</h3>
                    <ul>
                        <li><a href="http://wiki.1360.com/pages/viewpage.action?pageId=4819303" target="_blank">静床服务</a>
                        </li>
                        <li><a href="http://wiki.1360.com/pages/viewpage.action?pageId=4819334" target="_blank">静床使用指南</a></li>
                        <li><a href="http://wiki.1360.com/pages/viewpage.action?pageId=23461894" target="_blank">静床公共类库托管计划</a></li>
                        <li><a href="http://wiki.1360.com/pages/viewpage.action?pageId=7503972">Pylon下搭建Qstatic</a></li>
                    </ul>
                    <h3 id="qmodular-docs">静床模块化文档</h3>
                    <ul>
                        <li><a href="http://wiki.1360.com/pages/viewpage.action?pageId=92979950">静床模块化服务</a></li>
                    </ul>
                    <h3 id="seajs-docs">Seajs文档</h3>
                    <ul>
                        <li>
                            <a href="https://github.com/seajs/seajs/issues/258">seajs模块标记</a>
                        </li>
                        <li>
                            <a href="https://github.com/seajs/seajs/issues/266">seajs API</a>
                        </li>                        
                        <li>
                            <a href="https://github.com/seajs/seajs/issues/971">如何改造现有文件为CMD模块</a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /left col-->
            <!-- right col -->
            <div class="col-md-3">
                <div id="qm-docs-nav" class="qm-sidebar bs-sidebar">
                    <ul class="nav">
                        <li>
                            <a href="#why">为什么使用</a>
                        </li>
                        <li>
                            <a href="#howto">如何使用</a>
                            <ul class="nav">
                                <li><a href="#convention">使用约定</a></li>
                                <li><a href="#method">使用方法</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#other-docs">其它文档</a>
                            <ul class="nav">
                                <li><a href="#qstatic-docs">静床文档</a></li>
                                <li><a href="#qmodular-docs">静床模块化文档</a></li>
                            </ul>
                        </li>
                    </ul>
                    
                </div>
            </div>
            <!-- /right col -->
        </div> <!--end row-->
    </div><!--end docs-->
    <footer id="footer">
        <p>Copyright©2014 Qihoo and other contributors</p>
    </footer>
<script src="static/js/lib/jquery.js"></script>
<script src="static/js/lib/sea.js"></script>
<script src="static/js/config.js"></script>
<script>
seajs.use('docs/docs');
</script>
</body>
</html>
